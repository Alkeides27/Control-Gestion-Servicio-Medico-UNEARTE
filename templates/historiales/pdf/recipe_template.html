{% load static %}
<!DOCTYPE html>
<html lang="es" style="height: 100%;">
<head>
    <meta charset="UTF-8">
    <title>Récipe Médico</title>
    <style>
        /* La directiva @page se define en la vista (views.py) */
        
        body { 
            font-family: 'Helvetica', Arial, sans-serif; 
            font-size: 10pt; 
            color: #000;
            margin: 0;
            padding: 0;
            min-height: 100%; 
            display: flex;
            flex-direction: column;
        }
        
        .header-cintillo {
            width: 100%;
            margin-bottom: 10px;
        }

        .header-logos {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            line-height: 1.3;
            margin-bottom: 10px;
        }
        .header-logos .logo-left img { 
            max-width: 130px; 
        }
        .header-logos .header-right { 
            text-align: right; 
            font-size: 9pt;
        }
        .header-logos .header-right h4 { 
            margin: 0; 
            font-size: 1.1em; 
            font-weight: bold;
        }

        .content { 
            margin-top: 10px; 
            border: 1px solid #000; 
            padding: 10px; 
            
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .patient-info { 
            display: flex; 
            justify-content: space-between; 
            flex-wrap: wrap; 
            margin-bottom: 15px; 
            font-size: 9pt;
            flex-shrink: 0; 
        }
        .patient-info .data-field { 
            border-bottom: 1px dotted #333; 
            padding: 0 5px;
            width: 60%; 
        }
         .patient-info .data-field-small {
            border-bottom: 1px dotted #333; 
            padding: 0 5px;
            width: 35%;
         }

        .recipe-body { 
            line-height: 1.6; 
            margin-top: 20px;
            
            flex-grow: 1; 
            display: flex;
            flex-direction: column;
        }
        .recipe-body h5 { 
            margin: 5px 0 10px 0; 
            font-weight: bold; 
            text-decoration: underline; 
            text-align: center; 
        }
        
        .signature { 
            width: 45%; 
            text-align: center; 
            align-self: flex-end; 
            /* Se añade 'margin-top: auto' para empujarlo al fondo 
               del '.recipe-body' después de que el texto crezca.
            */
            margin-top: auto;
            padding-top: 20px; /* Un poco de espacio sobre la línea */
        }
        .signature .line { 
            border-top: 1px dotted #333; 
            width: 90%; 
            margin: 0 auto; 
        }
        .signature p { 
            margin: 5px 0 0 0; 
            font-size: 9pt; 
            font-weight: bold; 
        }


        .footer { 
            margin-top: auto;
            padding-top: 10px;
            width: 100%;
            flex-shrink: 0; 
        }
        .footer .address { 
            font-size: 8pt; 
            width: 100%; 
            line-height: 1.2; 
            text-align: center; 
        }
    </style>
</head>
<body style="min-height: 100%;">
    
    <img src="file://{{ cintillo_path }}" alt="Cintillo" class="header-cintillo">
    
    <div class="header-logos">
        <div class="logo-left">
            <img src="file://{{ unearte_logo_path }}" alt="Logo UNEARTE">
        </div>
        <div class="header-right">
            <h4>Servicio de Salud Integral</h4>
        </div>
    </div>

    <div class="content">
        <div class="patient-info">
            <span class="data-field"><strong>Nombre y Apellido:</strong> {{ paciente.get_full_name }}</span>
            <span class="data-field-small"><strong>Fecha:</strong> {{ historial.fecha|date:"d/m/Y" }}</span>
        </div>
        <div class="patient-info">
            <span class="data-field"><strong>Cédula:</strong> {{ paciente.numero_documento }}</span>
            <span class="data-field-small"><strong>Edad:</strong> {{ paciente.edad }}</span>
        </div>

        <div class="recipe-body">
            <h5>Récipe:</h5>
            
            <div style="padding-left: 10px; flex-grow: 1;">
                {{ recipe.texto_recipe|linebreaksbr }}
            </div>
            
            <div class="signature">
                <div class="line"></div>
                <p>Medico(a) (Nombre/Firma)</p>
                <p>{{ medico.get_full_name }}</p>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="address">
            <strong>DIRECCIÓN DE SALUD INTEGRAL</strong><br>
            Edif. Unearte, Av. México, entre UNEARTE y Teatro Teresa Carreño.
        </div>
    </div>

</body>
</html>